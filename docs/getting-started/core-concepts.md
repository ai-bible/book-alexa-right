# –ë–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

–ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π AI Writing System –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–º–∞–Ω–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è

AI Writing System –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤–æ–∫—Ä—É–≥ —Ç—Ä—ë—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö workflows, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–º–∞–Ω–∞:

```mermaid
graph TB
    subgraph "Planning Workflow"
        P[Strategic Planning] --> S[Storylines]
        S --> C[Chapters]
        C --> B[Blueprints]
    end

    subgraph "Generation Workflow"
        B --> V[Validation]
        V --> G[Generation]
        G --> Q[Quality Check]
    end

    subgraph "Integration Workflow"
        Q --> W[World State]
        W --> K[Character Knowledge]
        K --> L[Storylines Update]
    end

    style P fill:#e1f5ff
    style G fill:#ffe1e1
    style W fill:#e1ffe1
```

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. :material-chart-timeline: Hierarchical Planning

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ —Ç—Ä—ë—Ö —É—Ä–æ–≤–Ω–µ–π:

=== "Act Level"

    **Strategic Planning** ‚Äî –æ–±—â–µ–µ –≤–∏–¥–µ–Ω–∏–µ –∞–∫—Ç–∞:

    - –û—Å–Ω–æ–≤–Ω—ã–µ —Å—é–∂–µ—Ç–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã
    - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥—É–≥–∞ –∞–∫—Ç–∞
    - –†–∞–∑–≤–∏—Ç–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞
    - –ù–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –∞–∫—Ç–∞

    **–§–∞–π–ª**: `acts/act-{N}/strategic-plan.md`

=== "Chapter Level"

    **Chapter Planning** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–ª–∞–≤—ã:

    - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ü–µ–Ω
    - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è
    - Character development
    - Subplot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

    **–§–∞–π–ª**: `acts/act-{N}/chapters/chapter-{NN}/plan.md`

=== "Scene Level"

    **Scene Blueprints** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å—Ü–µ–Ω—ã:

    - Characters –∏ –∏—Ö goals
    - Conflicts –∏ tension sources
    - Emotional arc
    - Dialogue plan
    - Sensory details

    **–§–∞–π–ª**: `acts/act-{N}/chapters/chapter-{NN}/scenes/scene-{NNNN}-blueprint.md`

!!! info "Parent-Child Validation"

    –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã.

    –ù–∞–ø—Ä–∏–º–µ—Ä:
    - –ò–∑–º–µ–Ω–µ–Ω–∏–µ Chapter Plan ‚Üí –≤—Å–µ Scene Blueprints —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞
    - –ò–∑–º–µ–Ω–µ–Ω–∏–µ Act Plan ‚Üí –≤—Å–µ Chapters –∏ Scenes —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞

### 2. :material-robot: Specialized Agents

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤** –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á.

#### Planning Agents

| –ê–≥–µ–Ω—Ç | –ó–∞–¥–∞—á–∞ | –í—Ö–æ–¥—ã | –í—ã—Ö–æ–¥—ã |
|-------|--------|-------|--------|
| `context-analyzer` | –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏—Ä–∞ | World bible, characters, events | Context summary |
| `scenario-generator` | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–≤–∏—Ç–∏—è | Context, goals | 3-5 scenarios |
| `arc-planner` | –†–∞–∑–±–∏–≤–∞–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞ —Å–æ–±—ã—Ç–∏—è | Chosen scenario | Event sequence |
| `beat-planner` | –î–µ—Ç–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ü–µ–Ω—ã | Events | Scene blueprints |

#### Generation Agents

| –ê–≥–µ–Ω—Ç | –ó–∞–¥–∞—á–∞ | –í—Ö–æ–¥—ã | –í—ã—Ö–æ–¥—ã |
|-------|--------|-------|--------|
| `blueprint-validator` | –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç blueprint –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π | Blueprint file | Validation report |
| `prose-writer` | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç | Blueprint | Prose (Markdown) |
| `canon-guardian` | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–∞–Ω–æ–Ω—É | Prose, canon levels | Compliance report |
| `dialogue-analyst` | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –¥–∏–∞–ª–æ–≥–æ–≤ | Prose | Dialogue quality report |

!!! tip "Single Responsibility Principle"

    –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–æ–¥–Ω—É** —á—ë—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –∑–∞–¥–∞—á—É. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

    - –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
    - –õ—ë–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### 3. :material-file-tree: Artifact System

–ê–≥–µ–Ω—Ç—ã **–Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é** ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∞–π–ª—ã (artifacts).

```mermaid
graph LR
    A1[Agent 1] -->|writes| F[Artifact File]
    F -->|path| A2[Agent 2]
    A2 -->|reads| F

    style F fill:#ffe1e1
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:

- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç context overflow
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç observability (–≤—Å–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã)
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä**:

```python
# –ê–≥–µ–Ω—Ç 1: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç scenarios
scenarios_file = workspace / "artifacts" / "scenarios.json"
write_file(scenarios_file, scenarios)
return {"scenarios_path": str(scenarios_file)}

# –ê–≥–µ–Ω—Ç 2: –ß–∏—Ç–∞–µ—Ç scenarios
scenarios = read_file(scenarios_path)
```

### 4. :material-account-check: Human-in-the-Loop

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è **–≤—Å–µ–≥–¥–∞** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫:

| –≠—Ç–∞–ø | –†–µ—à–µ–Ω–∏–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏? |
|------|---------|----------------|
| –í—ã–±–æ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è | –ö–∞–∫–æ–π –∏–∑ 3-5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–≤–∏–≤–∞—Ç—å? | ‚ùå –ß–µ–ª–æ–≤–µ–∫ |
| Verification plan approval | –ù–∞—á–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é? | ‚ùå –ß–µ–ª–æ–≤–µ–∫ |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∏—Ä–∞ | –ù–æ–≤—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂/–ª–æ–∫–∞—Ü–∏—è? | ‚ùå –ß–µ–ª–æ–≤–µ–∫ |
| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π | –ß—Ç–æ –≤–∞–∂–Ω–µ–µ? | ‚ùå –ß–µ–ª–æ–≤–µ–∫ |
| –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ | –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å? | ‚ùå –ß–µ–ª–æ–≤–µ–∫ |

!!! warning "–®–∞–≥ 3 (Verification Plan) –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω"

    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ **–Ω–µ –Ω–∞—á–Ω—ë—Ç—Å—è** –±–µ–∑ –≤–∞—à–µ–≥–æ —è–≤–Ω–æ–≥–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è verification plan.

### 5. :material-database: Canon Levels

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é —á–µ—Ä–µ–∑ **5 —É—Ä–æ–≤–Ω–µ–π –∫–∞–Ω–æ–Ω–∞**:

| –£—Ä–æ–≤–µ–Ω—å | –ù–∞–∑–≤–∞–Ω–∏–µ | Immutable? | –ü—Ä–∏–º–µ—Ä—ã |
|---------|----------|------------|---------|
| **0** | Immutable Core | ‚úÖ –î–∞ | –ó–∞–∫–æ–Ω—ã —Ñ–∏–∑–∏–∫–∏, –±–∞–∑–æ–≤–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—è |
| **1** | Fundamental Lore | ‚úÖ –î–∞ | –ò—Å—Ç–æ—Ä–∏—è –º–∏—Ä–∞, major events |
| **2** | Established Canon | ‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ | –ü–µ—Ä—Å–æ–Ω–∞–∂–∏, –ª–æ–∫–∞—Ü–∏–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
| **3** | Working Details | üìù –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å | Detailing, minor characters |
| **4** | Draft Elements | üîÑ –°–≤–æ–±–æ–¥–Ω–æ | Experiments, drafts |

!!! example "–ü—Ä–∏–º–µ—Ä –∫–∞–Ω–æ–Ω–∞"

    ```markdown
    # Babylon (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –º–µ–≥–∞–ø–æ–ª–∏—Å)

    **Canon Level: 0** (Immutable Core)

    –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - 300+ —É—Ä–æ–≤–Ω–µ–π –≤—ã—Å–æ—Ç—ã
    - –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
    - –†–∞–∑–Ω–æ–µ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö
    ```

### 6. :material-source-branch: Session Management

–°–∏—Å—Ç–µ–º–∞ —Å–µ—Å—Å–∏–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ —Ä–∏—Å–∫–∞:

```mermaid
graph TB
    M[main session] --> E1[experiment-1]
    M --> E2[experiment-2]
    E1 --> E1V2[experiment-1-v2]
    E2 --> M2[merged back to main]

    style M fill:#e1ffe1
    style E1 fill:#ffe1e1
    style E2 fill:#e1f5ff
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:

- **Copy-on-Write**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–µ—Å—Å–∏–∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ main
- **Branching**: –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–æ–∫ –¥–ª—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **Merging**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

**–ö–æ–º–∞–Ω–¥—ã**:

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é
/session-create experiment-ending

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
/session-activate experiment-ending

# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ main
/session-activate main

# –°–ª–∏—è–Ω–∏–µ
/session-merge experiment-ending main
```

### 7. :material-state-machine: Workflow Orchestration

MCP —Å–µ—Ä–≤–µ—Ä `workflow-orchestration` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

#### Sequential Enforcement

–ù–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —à–∞–≥–∏:

```
Step 1 ‚úÖ ‚Üí Step 2 ‚úÖ ‚Üí Step 3 ‚ùå ‚Üí Step 4 ‚õî BLOCKED
```

#### Recovery After Failures

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ —à–∞–≥–∞:

```bash
/generation-state resume scene-0201
```

#### Retry Logic

–î–æ 3 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö:

```
Attempt 1/3... ‚ùå Failed (network error)
Attempt 2/3... ‚ùå Failed (timeout)
Attempt 3/3... ‚úÖ Success
```

### 8. :material-speedometer: Performance

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

=== "Planning Workflow"

    ```mermaid
    graph TB
        S[Scenario Selected] --> P1[World Details]
        S --> P2[Character Details]
        S --> P3[Dialogue Planning]
        S --> P4[Tension Design]
        P1 & P2 & P3 & P4 --> M[Merge Results]
    ```

    **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**: –î–æ 6 –∞–≥–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (—Ñ–∞–∑–∞ 2-3)

=== "Generation Workflow"

    ```mermaid
    graph TB
        G[Prose Generated] --> V1[Canon Guardian]
        G --> V2[Character Consistency]
        G --> V3[Dialogue Analyst]
        G --> V4[Temporal Logic]
        G --> V5[Emotional Arc]
        G --> V6[Sensory Details]
        G --> V7[Plot Consistency]
        V1 & V2 & V3 & V4 & V5 & V6 & V7 --> R[Final Report]
    ```

    **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**: 7 –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (Step 6)

**–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ–µ –≤—Ä–µ–º—è**:

- Planning: ~2-5 –º–∏–Ω—É—Ç –Ω–∞ —Å—Ü–µ–Ω—É
- Generation: ~5-8 –º–∏–Ω—É—Ç –Ω–∞ —Å—Ü–µ–Ω—É
- Full cycle: ~7-13 –º–∏–Ω—É—Ç

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ –¥–µ—Ç–∞–ª–∏:

<div class="grid cards" markdown>

-   [:octicons-workflow-24: Planning Workflow](../user-guide/planning/workflow-overview.md)
-   [:octicons-gear-24: Generation Workflow](../user-guide/generation/workflow-overview.md)
-   [:octicons-server-24: MCP Servers](../technical/mcp/overview.md)
-   [:octicons-robot-24: Agents Reference](../technical/agents/overview.md)

</div>
